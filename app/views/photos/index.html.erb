<div>
  <div>
    <h1>List of photos</h1>
  </div>
</div>

<hr>

<% if @current_user %>
  <div>
    <div>
      <h2>Add photo</h2>

      <form action="/photos" method="post" enctype="multipart/form-data" class="form-horizontal">
        <label for="caption_box">Caption</label>
        <textarea id="caption_box" name="photo[caption]" rows="3"></textarea>

        <label for="image_box">Image</label>
        <input type="file" id="image_box" name="photo[image]" class="form-control">

        <input type="hidden" value="<%= @current_user.id %>" name="photo[owner_id]">

        <button type="submit">Add photo</button>
      </form>
    </div>
  </div>
<% end %>

<hr>

<div>
  <div>
    <table border="1">
      <tr>
        <th>ID</th>
        <th>Caption</th>
        <th>Comments count</th>
        <th>Image</th>
        <th>Likes count</th>
        <th>Owner</th>
        <th>Created at</th>
        <th>Updated at</th>
        <th></th>
      </tr>

      <% @photos.each do |a_photo| %>
        <% if !a_photo.owner.private %>
          <tr>
            <td><%= a_photo.id %></td>
            <td><%= a_photo.caption %></td>
            <td><%= a_photo.comments.count %></td>
            <td><img src="<%= a_photo.image.url %>" class='small-image'></td>
            <td><%= a_photo.likes.count %></td>
            <td><%= a_photo.owner.username %></td> <!-- Display username instead of ID -->
            <td><%= time_ago_in_words(a_photo.created_at) %> ago</td>
            <td><%= time_ago_in_words(a_photo.updated_at) %> ago</td>
            <td><a href="/photos/<%= a_photo.id %>">Show details</a></td>
          </tr>
        <% end %>
      <% end %>
    </table>
  </div>
</div>

<hr>
